<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Auctioneer - Live Auction Control</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body class="bg-gradient-to-br from-gray-900 to-blue-900 min-h-screen text-white">
    <div class="container mx-auto px-4 py-6">
        <!-- Header -->
        <header class="glass-panel rounded-2xl p-6 mb-6">
            <div class="flex flex-col md:flex-row justify-between items-center gap-4">
                <div>
                    <h1 class="text-3xl font-bold mb-2 bg-gradient-to-r from-yellow-400 to-orange-500 bg-clip-text text-transparent">
                        Auctioneer Control Panel
                    </h1>
                    <div class="flex items-center space-x-4">
                        <div id="connectionStatus" class="flex items-center space-x-2">
                            <div class="w-2 h-2 rounded-full bg-green-500 animate-pulse"></div>
                            <span class="text-sm text-gray-300">Connected</span>
                        </div>
                        <span class="text-sm text-gray-400">Live Auction Pool</span>
                    </div>
                </div>
                
                <div class="text-right">
                    <div class="text-sm text-gray-400">ROOM CODE</div>
                    <div id="roomCode" class="text-2xl font-bold tracking-wider text-yellow-400">----</div>
                    <div class="text-xs text-gray-500 mt-1">Auctioneer View</div>
                </div>
            </div>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- Left Column: Current Player & Controls -->
            <div class="lg:col-span-2 space-y-6">
                <!-- Current Player Card -->
                <div id="currentPlayerSection" class="glass-panel rounded-2xl p-6 hidden slide-in">
                    <div class="flex flex-col md:flex-row items-center md:items-start gap-6">
                        <!-- Player Image -->
                        <div class="w-40 h-40 rounded-xl bg-gray-800/50 flex items-center justify-center overflow-hidden">
                            <div id="playerImage" class="w-full h-full bg-gradient-to-br from-gray-700 to-gray-900 flex items-center justify-center">
                                <span class="text-4xl">üèè</span>
                            </div>
                        </div>
                        
                        <!-- Player Details -->
                        <div class="flex-1">
                            <div class="flex flex-col md:flex-row justify-between items-start mb-4">
                                <div>
                                    <div class="text-sm text-gray-400 mb-1">CURRENT PLAYER</div>
                                    <h2 id="playerName" class="text-3xl font-bold text-yellow-400 mb-2">Waiting for Player...</h2>
                                    <div class="flex flex-wrap gap-2">
                                        <span id="playerRole" class="px-3 py-1 bg-blue-900/50 text-blue-300 rounded-lg text-sm">Role</span>
                                        <span id="playerType" class="px-3 py-1 bg-purple-900/50 text-purple-300 rounded-lg text-sm">Type</span>
                                        <span id="playerNationality" class="px-3 py-1 bg-green-900/50 text-green-300 rounded-lg text-sm">Nationality</span>
                                    </div>
                                </div>
                                
                                <!-- Bid Info -->
                                <div class="mt-4 md:mt-0 text-center md:text-right">
                                    <div class="text-sm text-gray-400">CURRENT HIGHEST BID</div>
                                    <div id="currentBid" class="text-4xl font-bold text-yellow-400 mt-1">‚Çπ0 Cr</div>
                                    <div id="highestTeam" class="text-lg text-gray-300 mt-2">No bids yet</div>
                                    <div class="text-sm text-gray-400 mt-1">Base: <span id="basePrice" class="text-yellow-300">‚Çπ0 Cr</span></div>
                                </div>
                            </div>
                            
                            <!-- Player Stats -->
                            <div class="mt-6">
                                <div class="text-sm text-gray-400 mb-3">PLAYER STATISTICS</div>
                                <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
                                    <div class="stat-card">
                                        <div class="text-xs text-gray-400">Total Runs</div>
                                        <div id="statRuns" class="text-lg font-bold">0</div>
                                    </div>
                                    <div class="stat-card">
                                        <div class="text-xs text-gray-400">Strike Rate</div>
                                        <div id="statStrikeRate" class="text-lg font-bold">0</div>
                                    </div>
                                    <div class="stat-card">
                                        <div class="text-xs text-gray-400">Wickets</div>
                                        <div id="statWickets" class="text-lg font-bold">0</div>
                                    </div>
                                    <div class="stat-card">
                                        <div class="text-xs text-gray-400">Economy</div>
                                        <div id="statEconomy" class="text-lg font-bold">0</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Empty State -->
                <div id="emptyState" class="glass-panel rounded-2xl p-12 text-center slide-in">
                    <div class="text-6xl mb-4">‚è≥</div>
                    <h3 class="text-2xl font-bold text-gray-300 mb-2">Waiting for Auction to Start</h3>
                    <p class="text-gray-500">The auction pool will begin shortly...</p>
                    <div class="mt-6 flex items-center justify-center space-x-2">
                        <div class="w-2 h-2 bg-blue-500 rounded-full animate-pulse"></div>
                        <div class="w-2 h-2 bg-blue-500 rounded-full animate-pulse" style="animation-delay: 0.2s"></div>
                        <div class="w-2 h-2 bg-blue-500 rounded-full animate-pulse" style="animation-delay: 0.4s"></div>
                    </div>
                </div>

                <!-- Auctioneer Controls -->
                <div class="glass-panel rounded-2xl p-6 slide-in">
                    <h2 class="text-2xl font-bold text-yellow-400 mb-6">Auction Controls</h2>
                    
                    <!-- Action Buttons -->
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                        <button id="sellBtn"
                                class="py-4 rounded-xl font-semibold bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 transition-all duration-300 disabled:opacity-40 disabled:cursor-not-allowed text-lg"
                                disabled>
                            ‚úÖ SELL PLAYER
                        </button>

                        <button id="unsoldBtn"
                                class="py-4 rounded-xl font-semibold bg-gradient-to-r from-red-500 to-rose-600 hover:from-red-600 hover:to-rose-700 transition-all duration-300 disabled:opacity-40 disabled:cursor-not-allowed text-lg"
                                disabled>
                            ‚ùå MARK UNSOLD
                        </button>

                        <button id="nextBtn"
                                class="py-4 rounded-xl font-semibold bg-gradient-to-r from-blue-500 to-cyan-600 hover:from-blue-600 hover:to-cyan-700 transition-all duration-300 disabled:opacity-40 disabled:cursor-not-allowed text-lg"
                                disabled>
                            ‚è≠ NEXT PLAYER
                        </button>
                        
                        <button id="endAuctionBtn"
                                class="py-4 rounded-xl font-semibold bg-gradient-to-r from-purple-500 to-pink-600 hover:from-purple-600 hover:to-pink-700 transition-all duration-300 text-lg">
                            üèÅ END AUCTION
                        </button>
                    </div>
                    
                    <!-- Status Info -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div class="bg-gray-800/50 p-4 rounded-xl">
                            <div class="text-sm text-gray-400">Category</div>
                            <div id="auctionCategory" class="text-xl font-bold text-yellow-400">-</div>
                        </div>
                        <div class="bg-gray-800/50 p-4 rounded-xl">
                            <div class="text-sm text-gray-400">Players Left</div>
                            <div id="playersLeft" class="text-xl font-bold text-green-400">-</div>
                        </div>
                        <div class="bg-gray-800/50 p-4 rounded-xl">
                            <div class="text-sm text-gray-400">Unsold Players</div>
                            <div id="unsoldCount" class="text-xl font-bold text-red-400">0</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Column: Auction Log & Info -->
            <div class="space-y-6">
                <!-- Auction Statistics -->
                <div class="glass-panel rounded-2xl p-6 slide-in">
                    <h3 class="text-xl font-bold text-yellow-400 mb-4">Auction Statistics</h3>
                    <div class="space-y-4">
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Total Players Sold:</span>
                            <span id="totalSold" class="font-bold text-green-400">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Total Amount:</span>
                            <span id="totalAmount" class="font-bold text-yellow-400">‚Çπ0 Cr</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Active Teams:</span>
                            <span id="activeTeams" class="font-bold text-blue-400">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Average Bid:</span>
                            <span id="averageBid" class="font-bold text-purple-400">‚Çπ0 Cr</span>
                        </div>
                    </div>
                </div>
                
                <!-- Live Bid Log -->
                <div class="glass-panel rounded-2xl p-6 slide-in">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-bold text-yellow-400">Live Bid Log</h3>
                        <button id="clearBidLogBtn" class="text-xs text-gray-400 hover:text-gray-300 px-3 py-1 bg-gray-800/50 rounded-lg">
                            Clear
                        </button>
                    </div>
                    <div id="bidLog" class="space-y-2 max-h-96 overflow-y-auto pr-2">
                        <div class="text-gray-500 text-center py-8">No bids yet</div>
                    </div>
                </div>
                
                <!-- Quick Actions -->
                <div class="glass-panel rounded-2xl p-6 slide-in">
                    <h3 class="text-xl font-bold text-yellow-400 mb-4">Quick Actions</h3>
                    <div class="space-y-3">
                        <button id="skipPlayerBtn" 
                                class="w-full py-2 bg-gradient-to-r from-gray-700 to-gray-800 hover:from-gray-800 hover:to-gray-900 rounded-lg font-medium">
                            ‚è≠ Skip Current Player
                        </button>
                        <button id="forceNextBtn" 
                                class="w-full py-2 bg-gradient-to-r from-orange-700 to-amber-800 hover:from-orange-800 hover:to-amber-900 rounded-lg font-medium">
                            ‚è© Force Next Player
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Alert Modal -->
    <div id="alertModal" class="fixed inset-0 flex items-center justify-center z-50 hidden">
        <div class="absolute inset-0 bg-black/80"></div>
        <div class="glass-panel rounded-2xl p-6 max-w-md w-11/12 z-10">
            <div class="text-center">
                <div class="text-4xl mb-4" id="modalIcon">‚ö†Ô∏è</div>
                <h3 class="text-2xl font-bold mb-2" id="modalTitle">Alert</h3>
                <p class="text-gray-300 mb-6" id="modalMessage">This is a modal message</p>
                <button onclick="closeModal()" 
                        class="px-6 py-2 bg-gradient-to-r from-yellow-500 to-orange-500 rounded-lg font-semibold">
                    OK
                </button>
            </div>
        </div>
    </div>

    <script>
        // ========== GLOBAL VARIABLES ==========
        const socket = io();
        let currentRoomCode = null;
        let currentPlayer = null;
        let decisionTaken = false;
        let auctionStats = {
            totalSold: 0,
            totalAmount: 0,
            activeTeams: new Set(),
            bidCount: 0
        };

        // ========== DOM ELEMENTS ==========
        const roomCodeEl = document.getElementById('roomCode');
        const connectionStatus = document.getElementById('connectionStatus');
        const currentPlayerSection = document.getElementById('currentPlayerSection');
        const emptyState = document.getElementById('emptyState');
        const playerNameEl = document.getElementById('playerName');
        const playerRoleEl = document.getElementById('playerRole');
        const playerTypeEl = document.getElementById('playerType');
        const playerNationalityEl = document.getElementById('playerNationality');
        const currentBidEl = document.getElementById('currentBid');
        const highestTeamEl = document.getElementById('highestTeam');
        const basePriceEl = document.getElementById('basePrice');
        const statRuns = document.getElementById('statRuns');
        const statStrikeRate = document.getElementById('statStrikeRate');
        const statWickets = document.getElementById('statWickets');
        const statEconomy = document.getElementById('statEconomy');
        const auctionCategory = document.getElementById('auctionCategory');
        const playersLeft = document.getElementById('playersLeft');
        const unsoldCount = document.getElementById('unsoldCount');
        const sellBtn = document.getElementById('sellBtn');
        const unsoldBtn = document.getElementById('unsoldBtn');
        const nextBtn = document.getElementById('nextBtn');
        const endAuctionBtn = document.getElementById('endAuctionBtn');
        const bidLog = document.getElementById('bidLog');
        const clearBidLogBtn = document.getElementById('clearBidLogBtn');
        const skipPlayerBtn = document.getElementById('skipPlayerBtn');
        const forceNextBtn = document.getElementById('forceNextBtn');
        const totalSold = document.getElementById('totalSold');
        const totalAmount = document.getElementById('totalAmount');
        const activeTeams = document.getElementById('activeTeams');
        const averageBid = document.getElementById('averageBid');

        // ========== INITIALIZATION ==========
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üé§ Auctioneer auction page loading...');
            
            // Get room code from URL or localStorage
            const urlParams = new URLSearchParams(window.location.search);
            currentRoomCode = urlParams.get('roomCode') || localStorage.getItem('auctioneerRoomCode');
            
            if (!currentRoomCode) {
                showAlert('No Room Code', 'Redirecting to auctioneer panel...', '‚ùå');
                setTimeout(() => {
                    window.location.href = 'auctioneer.html';
                }, 2000);
                return;
            }
            
            roomCodeEl.textContent = currentRoomCode;
            
            console.log(`üîó Joining room: ${currentRoomCode}`);
            
            // Join as auctioneer
            socket.emit('joinAuctioneer', { roomCode: currentRoomCode });
            
            // Setup event listeners
            setupEventListeners();
        });

        function setupEventListeners() {
            // Control buttons
            sellBtn.addEventListener('click', () => sellCurrentPlayer());
            unsoldBtn.addEventListener('click', () => markUnsold());
            nextBtn.addEventListener('click', () => nextPlayer());
            endAuctionBtn.addEventListener('click', () => endAuction());
            clearBidLogBtn.addEventListener('click', clearBidLog);
            skipPlayerBtn.addEventListener('click', () => skipPlayer());
            forceNextBtn.addEventListener('click', () => forceNextPlayer());
            
            // Socket events
            setupSocketEvents();
        }

        function setupSocketEvents() {
            socket.on('connect', () => {
                console.log('‚úÖ Connected to server');
                updateConnectionStatus('Connected', 'green');
                
                if (currentRoomCode) {
                    socket.emit('joinAuctioneer', { roomCode: currentRoomCode });
                }
            });
            
            socket.on('connect_error', (error) => {
                console.error('‚ùå Connection error:', error);
                updateConnectionStatus('Disconnected', 'red');
                showAlert('Connection Error', 'Cannot connect to server. Please refresh.', '‚ùå');
            });
            
            socket.on('disconnect', () => {
                console.log('‚ùå Disconnected from server');
                updateConnectionStatus('Disconnected', 'red');
            });
            
            // Player starts auction
            socket.on('playerUpForAuction', ({ player, category }) => {
                console.log('üéØ New player up for auction:', player);
                
                decisionTaken = false;
                currentPlayer = player;
                
                // Hide empty state, show player section
                emptyState.classList.add('hidden');
                currentPlayerSection.classList.remove('hidden');
                
                // Update player info
                updatePlayerInfo(player);
                
                // Update category
                auctionCategory.textContent = category || '-';
                auctionCategory.className = 'text-xl font-bold text-yellow-400';
                
                // Enable sell/unsold buttons, disable next
                sellBtn.disabled = false;
                unsoldBtn.disabled = false;
                nextBtn.disabled = true;
                
                // Add log entry
                addToLog('NEW_PLAYER', `Starting auction for ${player.name}`, 'blue');
            });
            
            // Bid update
            socket.on('bidUpdate', ({ team, bid, playerId }) => {
                console.log('üí∞ Bid update:', team, bid);
                
                // Update current bid display
                currentBidEl.textContent = `‚Çπ${bid} Cr`;
                highestTeamEl.textContent = team.toUpperCase();
                
                // Update stats
                auctionStats.activeTeams.add(team);
                auctionStats.bidCount++;
                updateStats();
                
                // Add to bid log
                addBidToLog(team, bid);
                
                // Add team color
                const teamColors = {
                    'csk': '#FFCC00', 'mi': '#0048A0', 'rcb': '#D5152C',
                    'kkr': '#3A225D', 'dc': '#004C93', 'pbks': '#ED1B24',
                    'rr': '#FF4C93', 'srh': '#FF6F3D', 'gt': '#1E2D4A', 'lsg': '#A5E1F4'
                };
                
                highestTeamEl.style.color = teamColors[team] || '#FFFFFF';
            });
            
            // Auction status update
            socket.on('auctionUpdate', (data) => {
                console.log('üìä Auction update:', data);
                updateAuctionStatus(data);
            });
            
            // Player sold
            socket.on('playerSold', ({ player, team, price }) => {
                console.log('‚úÖ Player sold:', player, 'to', team, 'for', price);
                
                // Update stats
                auctionStats.totalSold++;
                auctionStats.totalAmount += price;
                updateStats();
                
                // Add to log
                addToLog('SOLD', `${player} ‚Üí ${team.toUpperCase()} for ‚Çπ${price} Cr`, 'green');
                
                // Disable sell/unsold, enable next
                sellBtn.disabled = true;
                unsoldBtn.disabled = true;
                nextBtn.disabled = false;
                decisionTaken = true;
                
                // Show RTM notification if applicable
                if (currentPlayer && currentPlayer.originalTeam && currentPlayer.originalTeam !== team) {
                    setTimeout(() => {
                        addToLog('RTM_AVAILABLE', `RTM available for ${currentPlayer.originalTeam}`, 'yellow');
                    }, 1000);
                }
                
                // Hide player section after delay if next not clicked
                setTimeout(() => {
                    if (!decisionTaken) {
                        currentPlayerSection.classList.add('hidden');
                        emptyState.classList.remove('hidden');
                    }
                }, 5000);
            });
            
            // Player unsold
            socket.on('playerUnsold', ({ player }) => {
                console.log('‚ùå Player unsold:', player);
                
                // Add to log
                addToLog('UNSOLD', `${player} went unsold`, 'red');
                
                // Disable sell/unsold, enable next
                sellBtn.disabled = true;
                unsoldBtn.disabled = true;
                nextBtn.disabled = false;
                decisionTaken = true;
                
                // Update unsold count
                unsoldCount.textContent = parseInt(unsoldCount.textContent) + 1;
                
                // Hide player section after delay if next not clicked
                setTimeout(() => {
                    if (!decisionTaken) {
                        currentPlayerSection.classList.add('hidden');
                        emptyState.classList.remove('hidden');
                    }
                }, 3000);
            });
            
            // RTM result
            socket.on('rtmResult', (data) => {
                console.log('üìù RTM result:', data);
                
                const message = data.success 
                    ? `RTM: ${data.player} retained by ${data.originalTeam} for ‚Çπ${data.rtmAmount} Cr`
                    : `RTM: ${data.player} goes to ${data.winningTeam}`;
                
                addToLog('RTM', message, data.success ? 'purple' : 'orange');
            });
            
            // Auction complete
            socket.on('auctionComplete', (data) => {
                console.log('üèÜ Auction complete:', data);
                
                addToLog('COMPLETE', 'Auction pool completed! All users redirected to playing 11.', 'blue');
                
                // Disable all buttons
                sellBtn.disabled = true;
                unsoldBtn.disabled = true;
                nextBtn.disabled = true;
                endAuctionBtn.disabled = true;
                endAuctionBtn.innerHTML = 'üèÅ Auction Ended';
                
                showAlert('Auction Complete', 'All players have been auctioned! Users are being redirected to playing 11 selection.', '‚úÖ');
                
                // Redirect after delay
                setTimeout(() => {
                    window.location.href = 'auctioneer.html';
                }, 5000);
            });
            
            // Error handling
            socket.on('error', (data) => {
                console.error('‚ùå Error:', data);
                showAlert('Error', data.message, '‚ùå');
            });
            
            socket.on('roomClosed', () => {
                showAlert('Room Closed', 'You have been disconnected from the room.', 'üö™');
                setTimeout(() => {
                    window.location.href = 'auctioneer.html';
                }, 3000);
            });
        }

        // ========== PLAYER FUNCTIONS ==========
        function updatePlayerInfo(player) {
            playerNameEl.textContent = player.name;
            playerRoleEl.textContent = player.role || 'Player';
            playerTypeEl.textContent = player.bowlingType || 'N/A';
            playerNationalityEl.textContent = player.nationality || 'Indian';
            currentBidEl.textContent = `‚Çπ${player.currentBid || player.basePrice} Cr`;
            highestTeamEl.textContent = player.currentBidder || 'No bids yet';
            basePriceEl.textContent = `‚Çπ${player.basePrice} Cr`;
            
            // Update stats
            statRuns.textContent = player.totalRuns || 0;
            statStrikeRate.textContent = player.strikeRate || 0;
            statWickets.textContent = player.wickets || 0;
            statEconomy.textContent = player.economyRate || 0;
            
            // Reset team color
            highestTeamEl.style.color = '#D1D5DB';
        }

        // ========== AUCTION CONTROL FUNCTIONS ==========
        function sellCurrentPlayer() {
            if (!currentRoomCode || !currentPlayer) return;
            
            if (confirm(`Sell ${currentPlayer.name} to ${highestTeamEl.textContent} for ${currentBidEl.textContent}?`)) {
                socket.emit('sellPlayer', { roomCode: currentRoomCode });
                decisionTaken = true;
            }
        }
        
        function markUnsold() {
            if (!currentRoomCode || !currentPlayer) return;
            
            if (confirm(`Mark ${currentPlayer.name} as UNSOLD?`)) {
                socket.emit('markUnsold', { roomCode: currentRoomCode });
                decisionTaken = true;
            }
        }
        
        function nextPlayer() {
            if (!currentRoomCode) return;
            
            socket.emit('nextPlayer', { roomCode: currentRoomCode });
            nextBtn.disabled = true;
            
            // Hide player section
            currentPlayerSection.classList.add('hidden');
            emptyState.classList.remove('hidden');
        }
        
        function endAuction() {
            if (!currentRoomCode) return;
            
            if (confirm('Are you sure you want to END the auction? This will complete the auction pool and redirect all users to playing 11 selection.')) {
                socket.emit('endAuction', { roomCode: currentRoomCode });
                endAuctionBtn.disabled = true;
                endAuctionBtn.innerHTML = 'üèÅ Ending...';
            }
        }
        
        function skipPlayer() {
            if (!currentRoomCode) return;
            
            if (confirm('Skip current player? Player will go to unsold pool.')) {
                socket.emit('skipPlayer', { roomCode: currentRoomCode });
                decisionTaken = true;
            }
        }
        
        function forceNextPlayer() {
            if (!currentRoomCode) return;
            
            socket.emit('nextPlayer', { roomCode: currentRoomCode });
            nextBtn.disabled = true;
            
            // Hide player section
            currentPlayerSection.classList.add('hidden');
            emptyState.classList.remove('hidden');
        }

        // ========== LOG FUNCTIONS ==========
        function addBidToLog(team, bid) {
            const bidItem = document.createElement('div');
            bidItem.className = 'p-3 rounded-lg bg-gray-800/30 border-l-4 border-yellow-500 slide-in';
            
            const teamColors = {
                'csk': '#FFCC00', 'mi': '#0048A0', 'rcb': '#D5152C',
                'kkr': '#3A225D', 'dc': '#004C93', 'pbks': '#ED1B24',
                'rr': '#FF4C93', 'srh': '#FF6F3D', 'gt': '#1E2D4A', 'lsg': '#A5E1F4'
            };
            
            const teamColor = teamColors[team] || '#FFFFFF';
            
            bidItem.innerHTML = `
                <div class="flex justify-between items-center">
                    <div class="flex items-center space-x-2">
                        <div class="w-3 h-3 rounded-full" style="background: ${teamColor}"></div>
                        <span class="font-semibold" style="color: ${teamColor}">${team.toUpperCase()}</span>
                    </div>
                    <span class="font-bold text-yellow-400">‚Çπ${bid} Cr</span>
                </div>
                <div class="text-xs text-gray-400 mt-1">${new Date().toLocaleTimeString()}</div>
            `;
            
            bidLog.prepend(bidItem);
            
            // Limit log to 50 items
            if (bidLog.children.length > 50) {
                bidLog.removeChild(bidLog.lastChild);
            }
        }
        
        function addToLog(type, message, color = 'gray') {
            const logItem = document.createElement('div');
            logItem.className = `p-3 rounded-lg bg-${color}-900/20 border-l-4 border-${color}-500 slide-in`;
            
            const icons = {
                'NEW_PLAYER': 'üéØ',
                'SOLD': '‚úÖ',
                'UNSOLD': '‚ùå',
                'RTM': 'üîÑ',
                'RTM_AVAILABLE': 'üÉè',
                'COMPLETE': 'üèÜ'
            };
            
            logItem.innerHTML = `
                <div class="flex items-center space-x-2">
                    <span class="text-lg">${icons[type] || 'üìù'}</span>
                    <span class="font-medium">${message}</span>
                </div>
                <div class="text-xs text-gray-400 mt-1">${new Date().toLocaleTimeString()}</div>
            `;
            
            bidLog.prepend(logItem);
            
            // Limit log to 50 items
            if (bidLog.children.length > 50) {
                bidLog.removeChild(bidLog.lastChild);
            }
        }
        
        function clearBidLog() {
            bidLog.innerHTML = '<div class="text-gray-500 text-center py-8">No bids yet</div>';
        }

        // ========== STATUS FUNCTIONS ==========
        function updateAuctionStatus(data) {
            if (data.category) auctionCategory.textContent = data.category;
            if (data.playersLeft !== undefined) playersLeft.textContent = data.playersLeft;
            if (data.unsoldCount !== undefined) unsoldCount.textContent = data.unsoldCount;
            
            if (data.currentBid && !decisionTaken) {
                currentBidEl.textContent = `‚Çπ${data.currentBid} Cr`;
                if (data.currentBidder) {
                    highestTeamEl.textContent = data.currentBidder.toUpperCase();
                }
            }
        }
        
        function updateStats() {
            totalSold.textContent = auctionStats.totalSold;
            totalAmount.textContent = `‚Çπ${auctionStats.totalAmount.toFixed(2)} Cr`;
            activeTeams.textContent = auctionStats.activeTeams.size;
            
            const avgBid = auctionStats.bidCount > 0 
                ? auctionStats.totalAmount / auctionStats.bidCount 
                : 0;
            averageBid.textContent = `‚Çπ${avgBid.toFixed(2)} Cr`;
        }
        
        function updateConnectionStatus(status, color) {
            const colorClass = color === 'green' ? 'bg-green-500' : 'bg-red-500';
            connectionStatus.innerHTML = `
                <div class="w-2 h-2 rounded-full ${colorClass} mr-2 ${color === 'green' ? 'animate-pulse' : ''}"></div>
                <span>${status}</span>
            `;
        }

        // ========== HELPER FUNCTIONS ==========
        function showAlert(title, message, icon = '‚ö†Ô∏è') {
            const modal = document.getElementById('alertModal');
            document.getElementById('modalIcon').textContent = icon;
            document.getElementById('modalTitle').textContent = title;
            document.getElementById('modalMessage').textContent = message;
            modal.classList.remove('hidden');
        }
        
        function closeModal() {
            document.getElementById('alertModal').classList.add('hidden');
        }
        
        // Expose to global scope
        window.closeModal = closeModal;

        console.log('‚úÖ Auctioneer auction page loaded');
    </script>
</body>
</html>